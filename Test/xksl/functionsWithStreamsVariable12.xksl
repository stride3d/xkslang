shader TestIComposition
{
    stage stream float3 sComp: SCOMP;
	
	void ComputeComp(Streams s)
	{
		streams.sComp = s.sComp;
	}
};

shader TestShaderBase
{
	stage stream float3 sBase: SBASE;

	void Compute(Streams s)
	{
		s.sBase = 1;
	}
}

shader TestShaderMain: TestShaderBase
{
	stage stream float3 sMain: SMAIN;

	compose TestIComposition blends[];
	
	override void Compute(Streams s)
	{
		s.sMain = 2;
		base.Compute(s);
		
		var backup = streams;
		foreach(var blendStep in blends)
		{
			blendStep.ComputeComp(backup);
		}
	}
	
	void VSMain()
	{
		Compute(streams);
	}
	
	void PSMain()
	{
		//Compute(streams);
	}
}
